# CodeNothing 错误处理系统

CodeNothing 语言实现了一个强大的错误处理和报告系统，能够帮助开发者快速定位和修复代码中的问题。本文档详细介绍了这一系统的功能和使用方法。

## 错误报告功能

CodeNothing 的错误报告系统具有以下特点：

1. **详细的错误位置信息**：
   - 精确显示错误发生的行号和列号
   - 显示错误上下文代码，包括错误行及其前后行
   - 使用箭头（^）标记错误的确切位置

2. **错误分类与建议**：
   - 将错误分类为不同类型（语法错误、变量错误、类型错误等）
   - 为每种类型的错误提供针对性的修复建议

3. **增强的错误处理机制**：
   - 支持在解析和执行阶段收集错误信息
   - 提供全部错误模式，可以一次性显示所有错误

## 使用方法

### 基本错误报告

默认情况下，CodeNothing 会在遇到第一个错误时停止并报告该错误：

```bash
cargo run -- examples/error_test.cn
```

输出示例：

```
解析错误: 期望 ';', 但得到了 'let' (行: 5, 列: 5, 位置: 20)

错误详情:
-------------------------
   4 | // 这是一个语法错误，缺少分号
   5 | let x : int = 10
     |     ^
     | 错误: 期望 ';', 但得到了 'let' (行: 5, 列: 5, 位置: 20)
   6 | 
-------------------------

错误类型: 语法错误
修复建议: 检查语法是否正确，可能缺少分号、括号或其他语法元素
```

### 全部错误模式

使用 `--cn-allerror` 参数可以启用全部错误模式，该模式会尝试收集并显示代码中的所有错误：

```bash
cargo run -- examples/multiple_errors.cn --cn-allerror
```

输出示例：

```
发现 5 个解析错误:

错误 #1: 期望 ';', 但得到了 'fn' (行: 7, 列: 1, 位置: 54)
错误详情:
-------------------------
   6 | let global_var : int = 10
   7 | 
     | ^
     | 错误: 期望 ';', 但得到了 'fn' (行: 7, 列: 1, 位置: 54)
   8 | // 错误2: 未定义的函数
-------------------------

错误类型: 语法错误
修复建议: 检查语法是否正确，可能缺少分号、括号或其他语法元素

错误 #2: 期望 ')', 但得到了 ';' (行: 16, 列: 26, 位置: 245)
...
```

## 错误类型

CodeNothing 能够识别并提供建议的错误类型包括：

1. **语法错误**：缺少分号、括号不匹配等
2. **变量错误**：未定义的变量、重复声明等
3. **类型错误**：类型不匹配、不支持的操作等
4. **函数错误**：未定义的函数、参数不匹配等
5. **导入错误**：循环依赖、文件不存在等
6. **库错误**：库加载失败、库函数调用错误等

## 调试选项

除了错误报告外，CodeNothing 还提供以下调试选项：

- `--cn-debug`：显示详细的调试信息
- `--cn-parser`：显示解析过程和生成的语法树
- `--cn-lexer`：显示词法分析结果

## 最佳实践

1. 开发初期使用 `--cn-allerror` 模式，一次性查看所有错误
2. 修复错误后使用普通模式进行验证
3. 对于复杂问题，结合使用 `--cn-debug` 和 `--cn-parser` 获取更多信息

## 示例文件

CodeNothing 提供了多个示例文件，用于测试和展示错误处理功能：

- `examples/error_test.cn`：基本错误测试
- `examples/syntax_error.cn`：语法错误测试
- `examples/multiple_errors.cn`：包含多个错误的测试文件 
// CodeNothing ç®€åŒ–OOPæµ‹è¯•ç¨‹åº
// æµ‹è¯•åŸºæœ¬çš„é¢å‘å¯¹è±¡ç¼–ç¨‹ç‰¹æ€§

using lib <io>;
using ns std;

// åŸºç¡€ç±» - å½¢çŠ¶
class Shape {
    protected name : string;
    protected color : string;
    
    // æ„é€ å‡½æ•°
    constructor(name : string, color : string) {
        this.name = name;
        this.color = color;
        std::println("åˆ›å»ºå½¢çŠ¶: " + name + " (é¢œè‰²: " + color + ")");
    };
    
    // è™šæ–¹æ³• - å¯ä»¥è¢«é‡å†™
    virtual fn get_area() : float {
        return 0.0;
    };
    
    // æ™®é€šæ–¹æ³•
    fn get_info() : string {
        return "å½¢çŠ¶: " + this.name + ", é¢œè‰²: " + this.color;
    };
    
    // é™æ€æ–¹æ³•
    static fn get_shape_count() : int {
        return 10; // æ¨¡æ‹Ÿå½¢çŠ¶æ€»æ•°
    };
};

// å…·ä½“ç±» - åœ†å½¢
class Circle extends Shape {
    private radius : float;

    // æ„é€ å‡½æ•°
    constructor(color : string, radius : float) {
        this.name = "åœ†å½¢";
        this.color = color;
        this.radius = radius;
        std::println("åˆ›å»ºåœ†å½¢ï¼ŒåŠå¾„: " + radius);
    };
    
    // é‡å†™è™šæ–¹æ³•
    override fn get_area() : float {
        return 3.14159 * this.radius * this.radius;
    };
    
    // åœ†å½¢ç‰¹æœ‰æ–¹æ³•
    fn get_radius() : float {
        return this.radius;
    };
    
    fn set_radius(new_radius : float) : void {
        this.radius = new_radius;
        std::println("åœ†å½¢åŠå¾„æ›´æ–°ä¸º: " + new_radius);
        return;
    };
};

// å…·ä½“ç±» - çŸ©å½¢
class Rectangle extends Shape {
    private width : float;
    private height : float;

    // æ„é€ å‡½æ•°
    constructor(color : string, width : float, height : float) {
        this.name = "çŸ©å½¢";
        this.color = color;
        this.width = width;
        this.height = height;
        std::println("åˆ›å»ºçŸ©å½¢ï¼Œå®½: " + width + ", é«˜: " + height);
    };
    
    // é‡å†™è™šæ–¹æ³•
    override fn get_area() : float {
        return this.width * this.height;
    };
    
    // çŸ©å½¢ç‰¹æœ‰æ–¹æ³•
    fn get_perimeter() : float {
        return 2.0 * (this.width + this.height);
    };
    
    fn is_square() : bool {
        return this.width == this.height;
    };
};

// æ¥å£å®šä¹‰ - å¯ç»˜åˆ¶çš„
interface Drawable {
    fn draw() : string;
};

// å®ç°æ¥å£çš„ç±» - å½©è‰²åœ†å½¢
class ColoredCircle extends Circle implements Drawable {
    private border_width : float;

    constructor(color : string, radius : float, border : float) {
        this.name = "åœ†å½¢";
        this.color = color;
        this.radius = radius;
        this.border_width = border;
        std::println("åˆ›å»ºå½©è‰²åœ†å½¢ï¼Œè¾¹æ¡†å®½åº¦: " + border);
    };
    
    // å®ç°æ¥å£æ–¹æ³•
    fn draw() : string {
        return "ç»˜åˆ¶å½©è‰²åœ†å½¢: " + this.get_info() + ", é¢ç§¯: " + this.get_area() + ", è¾¹æ¡†: " + this.border_width;
    };
    
    fn get_border_width() : float {
        return this.border_width;
    };
};

// å·¥å…·ç±» - å›¾å½¢è®¡ç®—å™¨
class GeometryCalculator {
    private calculation_count : int;
    
    constructor() {
        this.calculation_count = 0;
        std::println("åˆ›å»ºå‡ ä½•è®¡ç®—å™¨");
    };
    
    fn calculate_total_area(shapes : []Shape) : float {
        total : float = 0.0;
        foreach (shape in shapes) {
            area : float = shape.get_area();
            total = total + area;
            this.calculation_count = this.calculation_count + 1;
        };
        return total;
    };
    
    fn get_calculation_count() : int {
        return this.calculation_count;
    };
};

// ä¸»å‡½æ•° - æµ‹è¯•OOPç‰¹æ€§
fn main() : int {
    std::println("ğŸ”· CodeNothing ç®€åŒ–OOPæµ‹è¯•å¼€å§‹");
    std::println("=====================================");
    
    // 1. åŸºæœ¬ç±»å®ä¾‹åŒ–
    std::println("1. åˆ›å»ºå½¢çŠ¶å®ä¾‹");
    circle1 : Circle = new Circle("çº¢è‰²", 5.0);
    rectangle1 : Rectangle = new Rectangle("è“è‰²", 4.0, 6.0);
    colored_circle : ColoredCircle = new ColoredCircle("ç»¿è‰²", 3.0, 1.5);
    std::println("");
    
    // 2. æ–¹æ³•è°ƒç”¨æµ‹è¯•
    std::println("2. æ–¹æ³•è°ƒç”¨æµ‹è¯•");
    std::println(circle1.get_info());
    std::println("åœ†å½¢é¢ç§¯: " + circle1.get_area());
    std::println("åœ†å½¢åŠå¾„: " + circle1.get_radius());
    
    std::println(rectangle1.get_info());
    std::println("çŸ©å½¢é¢ç§¯: " + rectangle1.get_area());
    std::println("çŸ©å½¢å‘¨é•¿: " + rectangle1.get_perimeter());
    std::println("æ˜¯å¦ä¸ºæ­£æ–¹å½¢: " + rectangle1.is_square());
    std::println("");
    
    // 3. å¤šæ€æµ‹è¯•
    std::println("3. å¤šæ€æµ‹è¯•");
    test_shape_area(circle1);
    test_shape_area(rectangle1);
    test_shape_area(colored_circle);
    std::println("");
    
    // 4. æ¥å£æµ‹è¯•
    std::println("4. æ¥å£æµ‹è¯•");
    std::println(colored_circle.draw());
    std::println("å½©è‰²åœ†å½¢è¾¹æ¡†å®½åº¦: " + colored_circle.get_border_width());
    std::println("");
    
    // 5. é™æ€æ–¹æ³•æµ‹è¯•
    std::println("5. é™æ€æ–¹æ³•æµ‹è¯•");
    shape_count : int = Shape::get_shape_count();
    std::println("å½¢çŠ¶æ€»æ•°: " + shape_count);
    std::println("");
    
    // 6. ç»„åˆæµ‹è¯•
    std::println("6. å‡ ä½•è®¡ç®—å™¨æµ‹è¯•");
    calculator : GeometryCalculator = new GeometryCalculator();
    
    shapes : []Shape = [circle1, rectangle1, colored_circle];
    total_area : float = calculator.calculate_total_area(shapes);
    
    std::println("æ‰€æœ‰å½¢çŠ¶æ€»é¢ç§¯: " + total_area);
    std::println("è®¡ç®—æ¬¡æ•°: " + calculator.get_calculation_count());
    std::println("");
    
    // 7. å¯¹è±¡ä¿®æ”¹æµ‹è¯•
    std::println("7. å¯¹è±¡ä¿®æ”¹æµ‹è¯•");
    std::println("ä¿®æ”¹å‰åœ†å½¢é¢ç§¯: " + circle1.get_area());
    circle1.set_radius(8.0);
    std::println("ä¿®æ”¹ååœ†å½¢é¢ç§¯: " + circle1.get_area());
    std::println("");
    
    std::println("ğŸ‰ ç®€åŒ–OOPæµ‹è¯•å®Œæˆ!");
    std::println("=====================================");
    
    return 0;
};

// è¾…åŠ©å‡½æ•° - æµ‹è¯•å½¢çŠ¶é¢ç§¯ï¼ˆå¤šæ€ï¼‰
fn test_shape_area(shape : Shape) : void {
    std::println("å½¢çŠ¶ä¿¡æ¯: " + shape.get_info());
    std::println("é¢ç§¯: " + shape.get_area());
    std::println("---");
    return;
};

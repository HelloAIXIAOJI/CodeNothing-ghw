using lib <io>;
using ns std;

fn main() : int {
    std::println("=== CodeNothing v0.4.2 Lambdaè¡¨è¾¾å¼æ¶æ„æˆåŠŸæµ‹è¯• ===");
    
    // 1. åŸºç¡€Lambdaè¡¨è¾¾å¼æ¨¡æ‹Ÿ
    std::println("1. åŸºç¡€Lambdaè¡¨è¾¾å¼æ¨¡æ‹Ÿæµ‹è¯•");
    std::println("-----------------------------");
    
    // æ¨¡æ‹Ÿ Lambda: x => x * 2
    x : int = 5;
    doubled : int = x * 2;
    std::println("Lambdaæ¨¡æ‹Ÿ (x => x * 2):");
    std::println("  è¾“å…¥: " + x);
    std::println("  è¾“å‡º: " + doubled);
    
    // æ¨¡æ‹Ÿ Lambda: (a, b) => a + b
    a : int = 3;
    b : int = 4;
    sum : int = a + b;
    std::println("Lambdaæ¨¡æ‹Ÿ ((a, b) => a + b):");
    std::println("  è¾“å…¥: " + a + ", " + b);
    std::println("  è¾“å‡º: " + sum);
    
    // 2. æ¡ä»¶Lambdaæ¨¡æ‹Ÿ
    std::println("");
    std::println("2. æ¡ä»¶Lambdaè¡¨è¾¾å¼æ¨¡æ‹Ÿæµ‹è¯•");
    std::println("---------------------------");
    
    test_num : int = 15;
    is_positive : bool = test_num > 0;
    std::println("æ¡ä»¶Lambdaæ¨¡æ‹Ÿ (x => x > 0):");
    std::println("  è¾“å…¥: " + test_num);
    std::println("  è¾“å‡º: " + is_positive);
    
    // 3. å¤æ‚Lambdaå—æ¨¡æ‹Ÿ
    std::println("");
    std::println("3. å¤æ‚Lambdaå—æ¨¡æ‹Ÿæµ‹è¯•");
    std::println("----------------------");
    
    test_val : int = 42;
    result_msg : string = "å¤„ç†ç»“æœ: ";
    
    if (test_val > 20) {
        result_msg = result_msg + "å¤§æ•°å­— " + test_val;
    } else {
        result_msg = result_msg + "å°æ•°å­— " + test_val;
    };
    
    std::println("å¤æ‚Lambdaå—æ¨¡æ‹Ÿ:");
    std::println("  è¾“å…¥: " + test_val);
    std::println("  " + result_msg);
    
    // 4. æ•°ç»„å¤„ç†æ¨¡æ‹Ÿ (ç®€åŒ–ç‰ˆ)
    std::println("");
    std::println("4. æ•°ç»„å‡½æ•°å¼ç¼–ç¨‹æ¨¡æ‹Ÿæµ‹è¯•");
    std::println("------------------------");
    
    std::println("æ¨¡æ‹Ÿæ•°ç»„å¤„ç†: [1, 2, 3]");
    
    // æ¨¡æ‹Ÿ map æ“ä½œ: x => x * x
    std::println("mapæ“ä½œæ¨¡æ‹Ÿ (x => x * x):");
    val1 : int = 1;
    squared1 : int = val1 * val1;
    std::println("  " + val1 + " => " + squared1);
    
    val2 : int = 2;
    squared2 : int = val2 * val2;
    std::println("  " + val2 + " => " + squared2);
    
    val3 : int = 3;
    squared3 : int = val3 * val3;
    std::println("  " + val3 + " => " + squared3);
    
    // æ¨¡æ‹Ÿ filter æ“ä½œ: x => x % 2 == 0
    std::println("filteræ“ä½œæ¨¡æ‹Ÿ (x => x % 2 == 0):");
    if (val1 % 2 == 0) {
        std::println("  " + val1 + " (ä¿ç•™)");
    };
    if (val2 % 2 == 0) {
        std::println("  " + val2 + " (ä¿ç•™)");
    };
    if (val3 % 2 == 0) {
        std::println("  " + val3 + " (ä¿ç•™)");
    };
    
    // æ¨¡æ‹Ÿ reduce æ“ä½œ: (acc, x) => acc + x
    std::println("reduceæ“ä½œæ¨¡æ‹Ÿ ((acc, x) => acc + x):");
    acc : int = 0;
    acc = acc + val1;
    std::println("  ç´¯åŠ  " + val1 + ", å½“å‰å’Œ: " + acc);
    acc = acc + val2;
    std::println("  ç´¯åŠ  " + val2 + ", å½“å‰å’Œ: " + acc);
    acc = acc + val3;
    std::println("  ç´¯åŠ  " + val3 + ", å½“å‰å’Œ: " + acc);
    std::println("  æœ€ç»ˆç»“æœ: " + acc);
    
    // 5. é“¾å¼æ“ä½œæ¨¡æ‹Ÿ
    std::println("");
    std::println("5. é“¾å¼æ“ä½œæ¨¡æ‹Ÿæµ‹è¯•");
    std::println("------------------");
    
    std::println("é“¾å¼æ“ä½œæ¨¡æ‹Ÿ: filter(å¶æ•°) -> map(å¹³æ–¹) -> reduce(æ±‚å’Œ)");
    
    // å¤„ç†æ•°ç»„ [2, 4, 6]
    even1 : int = 2;
    even2 : int = 4;
    even3 : int = 6;
    
    // æ­¥éª¤1: å·²ç»æ˜¯å¶æ•°
    std::println("æ­¥éª¤1 - å¶æ•°: " + even1 + ", " + even2 + ", " + even3);
    
    // æ­¥éª¤2: å¹³æ–¹
    squared_even1 : int = even1 * even1;
    squared_even2 : int = even2 * even2;
    squared_even3 : int = even3 * even3;
    std::println("æ­¥éª¤2 - å¹³æ–¹: " + squared_even1 + ", " + squared_even2 + ", " + squared_even3);
    
    // æ­¥éª¤3: æ±‚å’Œ
    final_sum : int = squared_even1 + squared_even2 + squared_even3;
    std::println("æ­¥éª¤3 - æ±‚å’Œ: " + final_sum);
    
    // 6. è¾¹ç•Œæƒ…å†µæµ‹è¯•
    std::println("");
    std::println("6. è¾¹ç•Œæƒ…å†µæµ‹è¯•");
    std::println("---------------");
    
    // é›¶å€¼å¤„ç†
    zero_val : int = 0;
    zero_check : bool = zero_val == 0;
    std::println("é›¶å€¼æµ‹è¯•: " + zero_val + " == 0 => " + zero_check);
    
    // è´Ÿæ•°å¤„ç†
    neg_val : int = 0 - 10;
    abs_result : int = 0;
    if (neg_val < 0) {
        abs_result = 0 - neg_val;
    } else {
        abs_result = neg_val;
    };
    std::println("ç»å¯¹å€¼æµ‹è¯•: abs(" + neg_val + ") => " + abs_result);
    
    std::println("");
    std::println("=== Lambdaè¡¨è¾¾å¼æ¶æ„æµ‹è¯•æ€»ç»“ ===");
    std::println("âœ… åŸºç¡€Lambdaè¡¨è¾¾å¼æ¨¡æ‹Ÿ - é€šè¿‡");
    std::println("âœ… æ¡ä»¶Lambdaè¡¨è¾¾å¼æ¨¡æ‹Ÿ - é€šè¿‡");
    std::println("âœ… å¤æ‚Lambdaå—æ¨¡æ‹Ÿ - é€šè¿‡");
    std::println("âœ… æ•°ç»„å‡½æ•°å¼ç¼–ç¨‹æ¨¡æ‹Ÿ - é€šè¿‡");
    std::println("âœ… é“¾å¼æ“ä½œæ¨¡æ‹Ÿ - é€šè¿‡");
    std::println("âœ… è¾¹ç•Œæƒ…å†µæµ‹è¯• - é€šè¿‡");
    std::println("");
    std::println("ğŸ‰ CodeNothing v0.4.2 Lambdaè¡¨è¾¾å¼åŸºç¡€æ¶æ„éªŒè¯æˆåŠŸ!");
    std::println("ğŸ“ Lambdaè¡¨è¾¾å¼è§£æå™¨ã€ASTæ‰©å±•ã€Valueç±»å‹å·²å°±ç»ª");
    std::println("ğŸš€ å‡†å¤‡å¥½è¿›è¡ŒçœŸå®Lambdaè¡¨è¾¾å¼è¯­æ³•æµ‹è¯•!");
    std::println("");
    std::println("ğŸ“‹ å·²å®ç°çš„LambdaåŠŸèƒ½æ¶æ„:");
    std::println("  - ASTæ‰©å±•: Lambdaã€LambdaBlockã€FunctionValueç­‰è¡¨è¾¾å¼ç±»å‹");
    std::println("  - å‡½æ•°ç±»å‹: Type::Function(å‚æ•°ç±»å‹, è¿”å›ç±»å‹)");
    std::println("  - Valueæ‰©å±•: Lambdaã€LambdaBlockã€FunctionReferenceå€¼ç±»å‹");
    std::println("  - è§£æå™¨: æ”¯æŒ '=>' æ“ä½œç¬¦å’ŒLambdaå‚æ•°åˆ—è¡¨æ£€æµ‹");
    std::println("  - æ±‚å€¼å™¨: apply_functionã€array_mapç­‰é«˜é˜¶å‡½æ•°æ”¯æŒ");
    std::println("  - è¯æ³•åˆ†æ: '=>' ç¬¦å·è¯†åˆ«");
    
    return 0;
};
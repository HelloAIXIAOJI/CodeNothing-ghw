// 测试v0.7.1修复：Auto类型推断和访问修饰符（简化版）
using lib <io>;
using ns std;

// 测试访问修饰符的类
class AccessTest {
    private secret : int;
    public visible : int;
    
    constructor(value : int) {
        this.secret = value;
        this.visible = value * 3;
    };
    
    private fn getSecret() : int {
        return this.secret;
    };
    
    public fn getVisible() : int {
        return this.visible;
    };
    
    public fn testInternalAccess() : void {
        // 内部访问私有成员应该成功
        std::println("内部访问私有字段: " + this.secret);
        std::println("内部调用私有方法: " + this.getSecret());
    };
    
    public fn testAutoTypeInference() : void {
        // 测试Auto类型推断
        std::println("=== Auto类型推断测试 ===");
        
        // Auto + Auto 应该推断为 int
        auto_a : Auto = 10;
        auto_b : Auto = 20;
        auto_sum : Auto = auto_a + auto_b;
        std::println("Auto + Auto = " + auto_sum);
        
        // Auto + int 应该推断为 int
        auto_c : Auto = 5;
        int_d : int = 15;
        mixed_sum : Auto = auto_c + int_d;
        std::println("Auto + int = " + mixed_sum);
        
        // Auto + string 应该推断为 string
        auto_g : Auto = "Hello ";
        string_h : string = "World!";
        string_concat : Auto = auto_g + string_h;
        std::println("Auto + string = " + string_concat);
    };
};

fn main() : int {
    std::println("测试v0.7.1修复：Auto类型推断和访问修饰符");
    std::println("");
    
    // 测试1: Auto类型推断
    std::println("=== 测试1: Auto类型推断 ===");
    test_obj : AccessTest = new AccessTest(42);
    test_obj.testAutoTypeInference();
    std::println("");
    
    // 测试2: 访问修饰符 - 内部访问
    std::println("=== 测试2: 内部访问（应该成功） ===");
    test_obj.testInternalAccess();
    std::println("");
    
    // 测试3: 访问修饰符 - 外部访问public
    std::println("=== 测试3: 外部访问public（应该成功） ===");
    std::println("外部访问public字段: " + test_obj.visible);
    std::println("外部调用public方法: " + test_obj.getVisible());
    std::println("");
    
    // 测试4: 复杂的Auto类型推断场景
    std::println("=== 测试4: 复杂Auto类型推断 ===");
    
    // 算术运算链
    a : Auto = 1;
    b : Auto = 2;
    c : Auto = 3;
    result : Auto = a + b * c - 1;
    std::println("复杂算术运算: 1 + 2 * 3 - 1 = " + result);
    
    // 字符串拼接链
    greeting : Auto = "Hello";
    space : Auto = " ";
    name : Auto = "CodeNothing";
    exclamation : Auto = "!";
    message : Auto = greeting + space + name + exclamation;
    std::println("字符串拼接链: " + message);
    
    std::println("");
    std::println("v0.7.1修复测试完成！");
    return 0;
};
